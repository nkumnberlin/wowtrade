---
import Layout from "../../../components/global/Layout/Layout.astro"
import { getCharacters } from "../../../api/services/Character"
import Characters from "../../../features/characters"
const cookie = Astro.cookies.get("wow-trade-session").value
const { pathname } = Astro.url
let characters
try {
	characters = await getCharacters(cookie)
} catch (e) {
	console.log("e", e)
}
---

<Layout title="Authenticate your Account">
	<div class="flex flex-row">
		<div class="basis-2/4">
			<Characters characters={characters} />
		</div>
	</div>
</Layout>

<script is:inline>
	const handleClick = (ev) => {
		const realm = ev.target.dataset.realm
		const name = ev.target.dataset.name
		// @ts-ignore
		window.location.href = `/authenticated/characters/professions/eu/${realm}/${name}`
	}
	console.log("load")

	const dataButtons = window?.document?.querySelectorAll("[data-realm]")
	console.log("clicks?", dataButtons)
	dataButtons.forEach((button) => button.addEventListener("click", handleClick))
</script>
